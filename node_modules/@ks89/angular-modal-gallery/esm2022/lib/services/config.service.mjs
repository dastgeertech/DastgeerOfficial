/*
 The MIT License (MIT)

 Copyright (C) 2017-2023 Stefano Cappa (Ks89)

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in all
 copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NON INFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.
 */
import { Injectable } from '@angular/core';
import { KS_DEFAULT_ACCESSIBILITY_CONFIG } from '../components/accessibility-default';
import { ButtonsStrategy } from '../model/buttons-config.interface';
import { GridLayout, LineLayout, PlainGalleryStrategy } from '../model/plain-gallery-config.interface';
import { LoadingType } from '../model/loading-config.interface';
import { DescriptionStrategy } from '../model/description.interface';
import * as i0 from "@angular/core";
export const DEFAULT_PREVIEW_SIZE = { height: '50px', width: 'auto' };
export const DEFAULT_LAYOUT = new LineLayout(DEFAULT_PREVIEW_SIZE, { length: -1, wrap: false }, 'flex-start');
export const DEFAULT_PLAIN_CONFIG = {
    strategy: PlainGalleryStrategy.ROW,
    layout: DEFAULT_LAYOUT,
    advanced: { aTags: false, additionalBackground: '50% 50%/cover' }
};
export const DEFAULT_LOADING = { enable: true, type: LoadingType.STANDARD };
export const DEFAULT_DESCRIPTION_STYLE = {
    bgColor: 'rgba(0, 0, 0, .5)',
    textColor: 'white',
    marginTop: '0px',
    marginBottom: '0px',
    marginLeft: '0px',
    marginRight: '0px'
};
export const DEFAULT_DESCRIPTION = {
    strategy: DescriptionStrategy.ALWAYS_VISIBLE,
    imageText: 'Image ',
    numberSeparator: '/',
    beforeTextDescription: ' - ',
    style: DEFAULT_DESCRIPTION_STYLE
};
export const DEFAULT_CAROUSEL_DESCRIPTION = {
    strategy: DescriptionStrategy.ALWAYS_HIDDEN,
    imageText: 'Image ',
    numberSeparator: '/',
    beforeTextDescription: ' - ',
    style: DEFAULT_DESCRIPTION_STYLE
};
export const DEFAULT_CURRENT_IMAGE_CONFIG = {
    navigateOnClick: true,
    loadingConfig: DEFAULT_LOADING,
    description: DEFAULT_DESCRIPTION,
    downloadable: false,
    invertSwipe: false
};
export const DEFAULT_CAROUSEL_IMAGE_CONFIG = {
    description: DEFAULT_CAROUSEL_DESCRIPTION,
    invertSwipe: false
};
export const DEFAULT_CURRENT_CAROUSEL_CONFIG = {
    maxWidth: '100%',
    maxHeight: '400px',
    showArrows: true,
    objectFit: 'cover',
    keyboardEnable: true,
    modalGalleryEnable: false
};
export const DEFAULT_CURRENT_CAROUSEL_PLAY = {
    autoPlay: true,
    interval: 5000,
    pauseOnHover: true
};
export const DEFAULT_CAROUSEL_BREAKPOINTS = { xSmall: 100, small: 100, medium: 150, large: 200, xLarge: 200 };
export const DEFAULT_CAROUSEL_PREVIEWS_CONFIG = {
    visible: true,
    number: 4,
    arrows: true,
    clickable: true,
    width: 100 / 4 + '%',
    maxHeight: '200px',
    breakpoints: DEFAULT_CAROUSEL_BREAKPOINTS
};
export const DEFAULT_SLIDE_CONFIG = {
    infinite: false,
    playConfig: { autoPlay: false, interval: 5000, pauseOnHover: true },
    sidePreviews: { show: true, size: { width: '100px', height: 'auto' } }
};
export const DEFAULT_PREVIEW_CONFIG = {
    visible: true,
    number: 3,
    arrows: true,
    clickable: true,
    size: DEFAULT_PREVIEW_SIZE
};
const DEFAULT_CONFIG = Object.freeze({
    slideConfig: DEFAULT_SLIDE_CONFIG,
    accessibilityConfig: KS_DEFAULT_ACCESSIBILITY_CONFIG,
    previewConfig: DEFAULT_PREVIEW_CONFIG,
    buttonsConfig: { visible: true, strategy: ButtonsStrategy.DEFAULT },
    dotsConfig: { visible: true },
    plainGalleryConfig: DEFAULT_PLAIN_CONFIG,
    currentImageConfig: DEFAULT_CURRENT_IMAGE_CONFIG,
    keyboardConfig: undefined,
    carouselConfig: DEFAULT_CURRENT_CAROUSEL_CONFIG,
    carouselImageConfig: DEFAULT_CAROUSEL_IMAGE_CONFIG,
    carouselPreviewsConfig: DEFAULT_CAROUSEL_PREVIEWS_CONFIG,
    carouselPlayConfig: DEFAULT_CURRENT_CAROUSEL_PLAY,
    carouselDotsConfig: { visible: true },
    carouselSlideInfinite: true,
    enableCloseOutside: true
});
/**
 * Service to handle library configuration in a unique place
 */
export class ConfigService {
    constructor() {
        this.configMap = new Map();
    }
    getConfig(id) {
        this.initIfNotExists(id);
        return this.configMap.get(id);
    }
    setConfig(id, obj) {
        this.initIfNotExists(id);
        if (!obj) {
            return;
        }
        if (!DEFAULT_CONFIG ||
            !DEFAULT_CONFIG.slideConfig ||
            !DEFAULT_CONFIG.slideConfig.sidePreviews ||
            !DEFAULT_CONFIG.previewConfig ||
            !DEFAULT_CONFIG.previewConfig.size ||
            !DEFAULT_CONFIG.previewConfig.number ||
            !DEFAULT_CONFIG.plainGalleryConfig ||
            !DEFAULT_CONFIG.currentImageConfig ||
            !DEFAULT_CONFIG.currentImageConfig ||
            !DEFAULT_CONFIG.currentImageConfig.description ||
            !DEFAULT_CONFIG.carouselImageConfig ||
            !DEFAULT_CONFIG.carouselImageConfig.description ||
            !DEFAULT_CONFIG.carouselPreviewsConfig ||
            !DEFAULT_CONFIG.carouselPreviewsConfig.breakpoints ||
            !DEFAULT_CAROUSEL_PREVIEWS_CONFIG.number) {
            throw new Error('Internal library error - DEFAULT_CONFIG must be fully initialized!!!');
        }
        const newConfig = Object.assign({}, this.configMap.get(id));
        if (obj.slideConfig) {
            let playConfig;
            let sidePreviews;
            let size;
            if (obj.slideConfig.playConfig) {
                playConfig = Object.assign({}, DEFAULT_CONFIG.slideConfig.playConfig, obj.slideConfig.playConfig);
            }
            else {
                playConfig = DEFAULT_CONFIG.slideConfig.playConfig;
            }
            if (obj.slideConfig.sidePreviews) {
                if (obj.slideConfig.sidePreviews.size) {
                    size = Object.assign({}, DEFAULT_CONFIG.slideConfig.sidePreviews.size, obj.slideConfig.sidePreviews.size);
                }
                else {
                    size = DEFAULT_CONFIG.slideConfig.sidePreviews.size;
                }
                sidePreviews = Object.assign({}, DEFAULT_CONFIG.slideConfig.sidePreviews, obj.slideConfig.sidePreviews);
            }
            else {
                sidePreviews = DEFAULT_CONFIG.slideConfig.sidePreviews;
                size = DEFAULT_CONFIG.slideConfig.sidePreviews.size;
            }
            const newSlideConfig = Object.assign({}, DEFAULT_CONFIG.slideConfig, obj.slideConfig);
            newSlideConfig.playConfig = playConfig;
            newSlideConfig.sidePreviews = sidePreviews;
            newSlideConfig.sidePreviews.size = size;
            newConfig.slideConfig = newSlideConfig;
        }
        if (obj.accessibilityConfig) {
            newConfig.accessibilityConfig = Object.assign({}, DEFAULT_CONFIG.accessibilityConfig, obj.accessibilityConfig);
        }
        if (obj.previewConfig) {
            let size;
            let num;
            if (obj.previewConfig.size) {
                size = Object.assign({}, DEFAULT_CONFIG.previewConfig.size, obj.previewConfig.size);
            }
            else {
                size = DEFAULT_CONFIG.previewConfig.size;
            }
            if (obj.previewConfig.number) {
                if (obj.previewConfig.number <= 0) {
                    // if number is <= 0 reset to default
                    num = DEFAULT_CONFIG.previewConfig.number;
                }
                else {
                    num = obj.previewConfig.number;
                }
            }
            else {
                num = DEFAULT_CONFIG.previewConfig.number;
            }
            const newPreviewConfig = Object.assign({}, DEFAULT_CONFIG.previewConfig, obj.previewConfig);
            newPreviewConfig.size = size;
            newPreviewConfig.number = num;
            newConfig.previewConfig = newPreviewConfig;
        }
        if (obj.buttonsConfig) {
            newConfig.buttonsConfig = Object.assign({}, DEFAULT_CONFIG.buttonsConfig, obj.buttonsConfig);
        }
        if (obj.dotsConfig) {
            newConfig.dotsConfig = Object.assign({}, DEFAULT_CONFIG.dotsConfig, obj.dotsConfig);
        }
        if (obj.plainGalleryConfig) {
            let advanced;
            let layout;
            if (obj.plainGalleryConfig.advanced) {
                advanced = Object.assign({}, DEFAULT_CONFIG.plainGalleryConfig.advanced, obj.plainGalleryConfig.advanced);
            }
            else {
                advanced = DEFAULT_CONFIG.plainGalleryConfig.advanced;
            }
            if (obj.plainGalleryConfig.layout) {
                // it isn't mandatory to use assign, because obj.plainGalleryConfig.layout is an instance of class (LineaLayout, GridLayout)
                layout = obj.plainGalleryConfig.layout;
            }
            else {
                layout = DEFAULT_CONFIG.plainGalleryConfig.layout;
            }
            const newPlainGalleryConfig = Object.assign({}, DEFAULT_CONFIG.plainGalleryConfig, obj.plainGalleryConfig);
            newPlainGalleryConfig.layout = layout;
            newPlainGalleryConfig.advanced = advanced;
            newConfig.plainGalleryConfig = initPlainGalleryConfig(newPlainGalleryConfig);
        }
        if (obj.currentImageConfig) {
            let loading;
            let description;
            let descriptionStyle;
            if (obj.currentImageConfig.loadingConfig) {
                loading = Object.assign({}, DEFAULT_CONFIG.currentImageConfig.loadingConfig, obj.currentImageConfig.loadingConfig);
            }
            else {
                loading = DEFAULT_CONFIG.currentImageConfig.loadingConfig;
            }
            if (obj.currentImageConfig.description) {
                description = Object.assign({}, DEFAULT_CONFIG.currentImageConfig.description, obj.currentImageConfig.description);
                if (obj.currentImageConfig.description.style) {
                    descriptionStyle = Object.assign({}, DEFAULT_CONFIG.currentImageConfig.description.style, obj.currentImageConfig.description.style);
                }
                else {
                    descriptionStyle = DEFAULT_CONFIG.currentImageConfig.description.style;
                }
            }
            else {
                description = DEFAULT_CONFIG.currentImageConfig.description;
                descriptionStyle = DEFAULT_CONFIG.currentImageConfig.description.style;
            }
            const newCurrentImageConfig = Object.assign({}, DEFAULT_CONFIG.currentImageConfig, obj.currentImageConfig);
            newCurrentImageConfig.loadingConfig = loading;
            newCurrentImageConfig.description = description;
            newCurrentImageConfig.description.style = descriptionStyle;
            newConfig.currentImageConfig = newCurrentImageConfig;
        }
        if (obj.keyboardConfig) {
            newConfig.keyboardConfig = Object.assign({}, DEFAULT_CONFIG.keyboardConfig, obj.keyboardConfig);
        }
        // carousel
        if (obj.carouselConfig) {
            newConfig.carouselConfig = Object.assign({}, DEFAULT_CONFIG.carouselConfig, obj.carouselConfig);
        }
        if (obj.carouselImageConfig) {
            let description;
            let descriptionStyle;
            if (obj.carouselImageConfig.description) {
                description = Object.assign({}, DEFAULT_CONFIG.carouselImageConfig.description, obj.carouselImageConfig.description);
                if (obj.carouselImageConfig.description.style) {
                    descriptionStyle = Object.assign({}, DEFAULT_CONFIG.carouselImageConfig.description.style, obj.carouselImageConfig.description.style);
                }
                else {
                    descriptionStyle = DEFAULT_CONFIG.carouselImageConfig.description.style;
                }
            }
            else {
                description = DEFAULT_CONFIG.carouselImageConfig.description;
                descriptionStyle = DEFAULT_CONFIG.carouselImageConfig.description.style;
            }
            const newCarouselImageConfig = Object.assign({}, DEFAULT_CONFIG.carouselImageConfig, obj.carouselImageConfig);
            newCarouselImageConfig.description = description;
            newCarouselImageConfig.description.style = descriptionStyle;
            newConfig.carouselImageConfig = newCarouselImageConfig;
        }
        if (obj.carouselPlayConfig) {
            // check values
            if (obj.carouselPlayConfig.interval <= 0) {
                throw new Error(`Carousel's interval must be a number >= 0`);
            }
            newConfig.carouselPlayConfig = Object.assign({}, DEFAULT_CONFIG.carouselPlayConfig, obj.carouselPlayConfig);
        }
        if (obj.carouselPreviewsConfig) {
            // check values
            let num;
            let breakpoints;
            if (!obj.carouselPreviewsConfig.number || obj.carouselPreviewsConfig.number <= 0) {
                num = DEFAULT_CAROUSEL_PREVIEWS_CONFIG.number;
            }
            else {
                num = obj.carouselPreviewsConfig.number;
            }
            if (obj.carouselPreviewsConfig.breakpoints) {
                breakpoints = Object.assign({}, DEFAULT_CONFIG.carouselPreviewsConfig.breakpoints, obj.carouselPreviewsConfig.breakpoints);
            }
            else {
                breakpoints = DEFAULT_CONFIG.carouselPreviewsConfig.breakpoints;
            }
            newConfig.carouselPreviewsConfig = Object.assign({}, DEFAULT_CONFIG.carouselPreviewsConfig, obj.carouselPreviewsConfig);
            newConfig.carouselPreviewsConfig.number = num;
            newConfig.carouselPreviewsConfig.breakpoints = breakpoints;
            // Init preview image width based on the number of previews in PreviewConfig
            // Don't move this line above, because I need to be sure that both configPreview.number
            // and configPreview.size are initialized
            newConfig.carouselPreviewsConfig.width = 100 / newConfig.carouselPreviewsConfig.number + '%';
        }
        if (obj.carouselDotsConfig) {
            newConfig.carouselDotsConfig = Object.assign({}, DEFAULT_CONFIG.carouselDotsConfig, obj.carouselDotsConfig);
        }
        if (obj.carouselSlideInfinite === undefined) {
            newConfig.carouselSlideInfinite = DEFAULT_CONFIG.carouselSlideInfinite;
        }
        else {
            newConfig.carouselSlideInfinite = obj.carouselSlideInfinite;
        }
        if (obj.enableCloseOutside === undefined) {
            newConfig.enableCloseOutside = DEFAULT_CONFIG.enableCloseOutside;
        }
        else {
            newConfig.enableCloseOutside = obj.enableCloseOutside;
        }
        this.configMap.set(id, newConfig);
    }
    initIfNotExists(id) {
        if (!this.configMap.has(id)) {
            this.configMap.set(id, DEFAULT_CONFIG);
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.0.5", ngImport: i0, type: ConfigService, deps: [], target: i0.ɵɵFactoryTarget.Injectable }); }
    static { this.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "17.0.5", ngImport: i0, type: ConfigService, providedIn: 'root' }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.0.5", ngImport: i0, type: ConfigService, decorators: [{
            type: Injectable,
            args: [{ providedIn: 'root' }]
        }] });
/**
 * Function to build and return a `PlainGalleryConfig` object, proving also default values and validating the input object.
 * @param plainGalleryConfig object with the config requested by user
 * @returns PlainGalleryConfig the plain gallery configuration
 * @throws an Error if layout and strategy aren't compatible
 */
function initPlainGalleryConfig(plainGalleryConfig) {
    const newPlayGalleryConfig = Object.assign({}, DEFAULT_CONFIG.plainGalleryConfig, plainGalleryConfig);
    if (newPlayGalleryConfig.layout instanceof LineLayout) {
        if (newPlayGalleryConfig.strategy !== PlainGalleryStrategy.ROW && newPlayGalleryConfig.strategy !== PlainGalleryStrategy.COLUMN) {
            throw new Error('LineLayout requires either ROW or COLUMN strategy');
        }
        if (!newPlayGalleryConfig.layout || !newPlayGalleryConfig.layout.breakConfig) {
            throw new Error('Both layout and breakConfig must be valid');
        }
    }
    if (newPlayGalleryConfig.layout instanceof GridLayout) {
        if (newPlayGalleryConfig.strategy !== PlainGalleryStrategy.GRID) {
            throw new Error('GridLayout requires GRID strategy');
        }
        if (!newPlayGalleryConfig.layout || !newPlayGalleryConfig.layout.breakConfig) {
            throw new Error('Both layout and breakConfig must be valid');
        }
        // force wrap for grid layout
        newPlayGalleryConfig.layout.breakConfig.wrap = true;
    }
    return newPlayGalleryConfig;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlnLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9rczg5L2FuZ3VsYXItbW9kYWwtZ2FsbGVyeS9zcmMvbGliL3NlcnZpY2VzL2NvbmZpZy5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBc0JHO0FBRUgsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUczQyxPQUFPLEVBQUUsK0JBQStCLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUd0RixPQUFPLEVBQWlCLGVBQWUsRUFBRSxNQUFNLG1DQUFtQyxDQUFDO0FBRW5GLE9BQU8sRUFBRSxVQUFVLEVBQUUsVUFBVSxFQUFzQixvQkFBb0IsRUFBRSxNQUFNLHlDQUF5QyxDQUFDO0FBRTNILE9BQU8sRUFBaUIsV0FBVyxFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFDL0UsT0FBTyxFQUFlLG1CQUFtQixFQUFvQixNQUFNLGdDQUFnQyxDQUFDOztBQU1wRyxNQUFNLENBQUMsTUFBTSxvQkFBb0IsR0FBUyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxDQUFDO0FBQzVFLE1BQU0sQ0FBQyxNQUFNLGNBQWMsR0FBZSxJQUFJLFVBQVUsQ0FBQyxvQkFBb0IsRUFBRSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEVBQUUsWUFBWSxDQUFDLENBQUM7QUFDMUgsTUFBTSxDQUFDLE1BQU0sb0JBQW9CLEdBQXVCO0lBQ3RELFFBQVEsRUFBRSxvQkFBb0IsQ0FBQyxHQUFHO0lBQ2xDLE1BQU0sRUFBRSxjQUFjO0lBQ3RCLFFBQVEsRUFBRSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsb0JBQW9CLEVBQUUsZUFBZSxFQUFFO0NBQ2xFLENBQUM7QUFDRixNQUFNLENBQUMsTUFBTSxlQUFlLEdB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SSxDQUFDLG9CQUFvQixDQUFDLE1BQU0sSUFBSSxDQUFDLG9CQUFvQixDQUFDLE1BQU0sQ0FBQyxXQUFXLEVBQUU7WUFDNUUsTUFBTSxJQUFJLEtBQUssQ0FBQywyQ0FBMkMsQ0FBQyxDQUFDO1NBQzlEO0tBQ0Y7SUFFRCxJQUFJLG9CQUFvQixDQUFDLE1BQU0sWUFBWSxVQUFVLEVBQUU7UUFDckQsSUFBSSxvQkFBb0IsQ0FBQyxRQUFRLEtBQUssb0JBQW9CLENBQUMsSUFBSSxFQUFFO1lBQy9ELE1BQU0sSUFBSSxLQUFLLENBQUMsbUNBQW1DLENBQUMsQ0FBQztTQUN0RDtRQUNELElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsV0FBVyxFQUFFO1lBQzVFLE1BQU0sSUFBSSxLQUFLLENBQUMsMkNBQTJDLENBQUMsQ0FBQztTQUM5RDtRQUNELDZCQUE2QjtRQUM3QixvQkFBb0IsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7S0FDckQ7SUFDRCxPQUFPLG9CQUFvQixDQUFDO0FBQzlCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuIFRoZSBNSVQgTGljZW5zZSAoTUlUKVxuXG4gQ29weXJpZ2h0IChDKSAyMDE3LTIwMjMgU3RlZmFubyBDYXBwYSAoS3M4OSlcblxuIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuXG4gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsXG4gY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OIElORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcbiBTT0ZUV0FSRS5cbiAqL1xuXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBTaWRlUHJldmlld3NDb25maWcsIFNsaWRlQ29uZmlnIH0gZnJvbSAnLi4vbW9kZWwvc2xpZGUtY29uZmlnLmludGVyZmFjZSc7XG5pbXBvcnQgeyBQbGF5Q29uZmlnIH0gZnJvbSAnLi4vbW9kZWwvcGxheS1jb25maWcuaW50ZXJmYWNlJztcbmltcG9ydCB7IEtTX0RFRkFVTFRfQUNDRVNTSUJJTElUWV9DT05GSUcgfSBmcm9tICcuLi9jb21wb25lbnRzL2FjY2Vzc2liaWxpdHktZGVmYXVsdCc7XG5pbXBvcnQgeyBQcmV2aWV3Q29uZmlnIH0gZnJvbSAnLi4vbW9kZWwvcHJldmlldy1jb25maWcuaW50ZXJmYWNlJztcbmltcG9ydCB7IFNpemUgfSBmcm9tICcuLi9tb2RlbC9zaXplLmludGVyZmFjZSc7XG5pbXBvcnQgeyBCdXR0b25zQ29uZmlnLCBCdXR0b25zU3RyYXRlZ3kgfSBmcm9tICcuLi9tb2RlbC9idXR0b25zLWNvbmZpZy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgRG90c0NvbmZpZyB9IGZyb20gJy4uL21vZGVsL2RvdHMtY29uZmlnLmludGVyZmFjZSc7XG5pbXBvcnQgeyBHcmlkTGF5b3V0LCBMaW5lTGF5b3V0LCBQbGFpbkdhbGxlcnlDb25maWcsIFBsYWluR2FsbGVyeVN0cmF0ZWd5IH0gZnJvbSAnLi4vbW9kZWwvcGxhaW4tZ2FsbGVyeS1jb25maWcuaW50ZXJmYWNlJztcbmltcG9ydCB7IEN1cnJlbnRJbWFnZUNvbmZpZyB9IGZyb20gJy4uL21vZGVsL2N1cnJlbnQtaW1hZ2UtY29uZmlnLmludGVyZmFjZSc7XG5pbXBvcnQgeyBMb2FkaW5nQ29uZmlnLCBMb2FkaW5nVHlwZSB9IGZyb20gJy4uL21vZGVsL2xvYWRpbmctY29uZmlnLmludGVyZmFjZSc7XG5pbXBvcnQgeyBEZXNjcmlwdGlvbiwgRGVzY3JpcHRpb25TdHJhdGVneSwgRGVzY3JpcHRpb25TdHlsZSB9IGZyb20gJy4uL21vZGVsL2Rlc2NyaXB0aW9uLmludGVyZmFjZSc7XG5pbXBvcnQgeyBDYXJvdXNlbENvbmZpZyB9IGZyb20gJy4uL21vZGVsL2Nhcm91c2VsLWNvbmZpZy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgQ2Fyb3VzZWxJbWFnZUNvbmZpZyB9IGZyb20gJy4uL21vZGVsL2Nhcm91c2VsLWltYWdlLWNvbmZpZy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgQnJlYWtwb2ludHNDb25maWcsIENhcm91c2VsUHJldmlld0NvbmZpZyB9IGZyb20gJy4uL21vZGVsL2Nhcm91c2VsLXByZXZpZXctY29uZmlnLmludGVyZmFjZSc7XG5pbXBvcnQgeyBMaWJDb25maWcgfSBmcm9tICcuLi9tb2RlbC9saWItY29uZmlnLmludGVyZmFjZSc7XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1BSRVZJRVdfU0laRTogU2l6ZSA9IHsgaGVpZ2h0OiAnNTBweCcsIHdpZHRoOiAnYXV0bycgfTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX0xBWU9VVDogTGluZUxheW91dCA9IG5ldyBMaW5lTGF5b3V0KERFRkFVTFRfUFJFVklFV19TSVpFLCB7IGxlbmd0aDogLTEsIHdyYXA6IGZhbHNlIH0sICdmbGV4LXN0YXJ0Jyk7XG5leHBvcnQgY29uc3QgREVGQVVMVF9QTEFJTl9DT05GSUc6IFBsYWluR2FsbGVyeUNvbmZpZyA9IHtcbiAgc3RyYXRlZ3k6IFBsYWluR2FsbGVyeVN0cmF0ZWd5LlJPVyxcbiAgbGF5b3V0OiBERUZBVUxUX0xBWU9VVCxcbiAgYWR2YW5jZWQ6IHsgYVRhZ3M6IGZhbHNlLCBhZGRpdGlvbmFsQmFja2dyb3VuZDogJzUwJSA1MCUvY292ZXInIH1cbn07XG5leHBvcnQgY29uc3QgREVGQVVMVF9MT0FESU5HOiBMb2FkaW5nQ29uZmlnID0geyBlbmFibGU6IHRydWUsIHR5cGU6IExvYWRpbmdUeXBlLlNUQU5EQVJEIH07XG5leHBvcnQgY29uc3QgREVGQVVMVF9ERVNDUklQVElPTl9TVFlMRTogRGVzY3JpcHRpb25TdHlsZSA9IHtcbiAgYmdDb2xvcjogJ3JnYmEoMCwgMCwgMCwgLjUpJyxcbiAgdGV4dENvbG9yOiAnd2hpdGUnLFxuICBtYXJnaW5Ub3A6ICcwcHgnLFxuICBtYXJnaW5Cb3R0b206ICcwcHgnLFxuICBtYXJnaW5MZWZ0OiAnMHB4JyxcbiAgbWFyZ2luUmlnaHQ6ICcwcHgnXG59O1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfREVTQ1JJUFRJT046IERlc2NyaXB0aW9uID0ge1xuICBzdHJhdGVneTogRGVzY3JpcHRpb25TdHJhdGVneS5BTFdBWVNfVklTSUJMRSxcbiAgaW1hZ2VUZXh0OiAnSW1hZ2UgJyxcbiAgbnVtYmVyU2VwYXJhdG9yOiAnLycsXG4gIGJlZm9yZVRleHREZXNjcmlwdGlvbjogJyAtICcsXG4gIHN0eWxlOiBERUZBVUxUX0RFU0NSSVBUSU9OX1NUWUxFXG59O1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfQ0FST1VTRUxfREVTQ1JJUFRJT046IERlc2NyaXB0aW9uID0ge1xuICBzdHJhdGVneTogRGVzY3JpcHRpb25TdHJhdGVneS5BTFdBWVNfSElEREVOLFxuICBpbWFnZVRleHQ6ICdJbWFnZSAnLFxuICBudW1iZXJTZXBhcmF0b3I6ICcvJyxcbiAgYmVmb3JlVGV4dERlc2NyaXB0aW9uOiAnIC0gJyxcbiAgc3R5bGU6IERFRkFVTFRfREVTQ1JJUFRJT05fU1RZTEVcbn07XG5leHBvcnQgY29uc3QgREVGQVVMVF9DVVJSRU5UX0lNQUdFX0NPTkZJRzogQ3VycmVudEltYWdlQ29uZmlnID0ge1xuICBuYXZpZ2F0ZU9uQ2xpY2s6IHRydWUsXG4gIGxvYWRpbmdDb25maWc6IERFRkFVTFRfTE9BRElORyxcbiAgZGVzY3JpcHRpb246IERFRkFVTFRfREVTQ1JJUFRJT04sXG4gIGRvd25sb2FkYWJsZTogZmFsc2UsXG4gIGludmVydFN3aXBlOiBmYWxzZVxufTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX0NBUk9VU0VMX0lNQUdFX0NPTkZJRzogQ2Fyb3VzZWxJbWFnZUNvbmZpZyA9IHtcbiAgZGVzY3JpcHRpb246IERFRkFVTFRfQ0FST1VTRUxfREVTQ1JJUFRJT04sXG4gIGludmVydFN3aXBlOiBmYWxzZVxufTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX0NVUlJFTlRfQ0FST1VTRUxfQ09ORklHOiBDYXJvdXNlbENvbmZpZyA9IHtcbiAgbWF4V2lkdGg6ICcxMDAlJyxcbiAgbWF4SGVpZ2h0OiAnNDAwcHgnLFxuICBzaG93QXJyb3dzOiB0cnVlLFxuICBvYmplY3RGaXQ6ICdjb3ZlcicsXG4gIGtleWJvYXJkRW5hYmxlOiB0cnVlLFxuICBtb2RhbEdhbGxlcnlFbmFibGU6IGZhbHNlXG59O1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfQ1VSUkVOVF9DQVJPVVNFTF9QTEFZOiBQbGF5Q29uZmlnID0ge1xuICBhdXRvUGxheTogdHJ1ZSxcbiAgaW50ZXJ2YWw6IDUwMDAsXG4gIHBhdXNlT25Ib3ZlcjogdHJ1ZVxufTtcblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfQ0FST1VTRUxfQlJFQUtQT0lOVFM6IEJyZWFrcG9pbnRzQ29uZmlnID0geyB4U21hbGw6IDEwMCwgc21hbGw6IDEwMCwgbWVkaXVtOiAxNTAsIGxhcmdlOiAyMDAsIHhMYXJnZTogMjAwIH07XG5leHBvcnQgY29uc3QgREVGQVVMVF9DQVJPVVNFTF9QUkVWSUVXU19DT05GSUc6IENhcm91c2VsUHJldmlld0NvbmZpZyA9IHtcbiAgdmlzaWJsZTogdHJ1ZSxcbiAgbnVtYmVyOiA0LFxuICBhcnJvd3M6IHRydWUsXG4gIGNsaWNrYWJsZTogdHJ1ZSxcbiAgd2lkdGg6IDEwMCAvIDQgKyAnJScsXG4gIG1heEhlaWdodDogJzIwMHB4JyxcbiAgYnJlYWtwb2ludHM6IERFRkFVTFRfQ0FST1VTRUxfQlJFQUtQT0lOVFNcbn07XG5leHBvcnQgY29uc3QgREVGQVVMVF9TTElERV9DT05GSUc6IFNsaWRlQ29uZmlnID0ge1xuICBpbmZpbml0ZTogZmFsc2UsXG4gIHBsYXlDb25maWc6IHsgYXV0b1BsYXk6IGZhbHNlLCBpbnRlcnZhbDogNTAwMCwgcGF1c2VPbkhvdmVyOiB0cnVlIH0gYXMgUGxheUNvbmZpZyxcbiAgc2lkZVByZXZpZXdzOiB7IHNob3c6IHRydWUsIHNpemU6IHsgd2lkdGg6ICcxMDBweCcsIGhlaWdodDogJ2F1dG8nIH0gfSBhcyBTaWRlUHJldmlld3NDb25maWdcbn07XG5leHBvcnQgY29uc3QgREVGQVVMVF9QUkVWSUVXX0NPTkZJRzogUHJldmlld0NvbmZpZyA9IHtcbiAgdmlzaWJsZTogdHJ1ZSxcbiAgbnVtYmVyOiAzLFxuICBhcnJvd3M6IHRydWUsXG4gIGNsaWNrYWJsZTogdHJ1ZSxcbiAgc2l6ZTogREVGQVVMVF9QUkVWSUVXX1NJWkVcbn07XG5cbmNvbnN0IERFRkFVTFRfQ09ORklHOiBMaWJDb25maWcgPSBPYmplY3QuZnJlZXplKHtcbiAgc2xpZGVDb25maWc6IERFRkFVTFRfU0xJREVfQ09ORklHLFxuICBhY2Nlc3NpYmlsaXR5Q29uZmlnOiBLU19ERUZBVUxUX0FDQ0VTU0lCSUxJVFlfQ09ORklHLFxuICBwcmV2aWV3Q29uZmlnOiBERUZBVUxUX1BSRVZJRVdfQ09ORklHLFxuICBidXR0b25zQ29uZmlnOiB7IHZpc2libGU6IHRydWUsIHN0cmF0ZWd5OiBCdXR0b25zU3RyYXRlZ3kuREVGQVVMVCB9IGFzIEJ1dHRvbnNDb25maWcsXG4gIGRvdHNDb25maWc6IHsgdmlzaWJsZTogdHJ1ZSB9IGFzIERvdHNDb25maWcsXG4gIHBsYWluR2FsbGVyeUNvbmZpZzogREVGQVVMVF9QTEFJTl9DT05GSUcsXG4gIGN1cnJlbnRJbWFnZUNvbmZpZzogREVGQVVMVF9DVVJSRU5UX0lNQUdFX0NPTkZJRyxcbiAga2V5Ym9hcmRDb25maWc6IHVuZGVmaW5lZCwgLy8gYnkgZGVmYXVsdCBub3RoaW5nLCBiZWNhdXNlIHRoZSBsaWJyYXJ5IHVzZXMgZGVmYXVsdCBidXR0b25zIGF1dG9tYXRpY2FsbHlcbiAgY2Fyb3VzZWxDb25maWc6IERFRkFVTFRfQ1VSUkVOVF9DQVJPVVNFTF9DT05GSUcsXG4gIGNhcm91c2VsSW1hZ2VDb25maWc6IERFRkFVTFRfQ0FST1VTRUxfSU1BR0VfQ09ORklHLFxuICBjYXJvdXNlbFByZXZpZXdzQ29uZmlnOiBERUZBVUxUX0NBUk9VU0VMX1BSRVZJRVdTX0NPTkZJRyxcbiAgY2Fyb3VzZWxQbGF5Q29uZmlnOiBERUZBVUxUX0NVUlJFTlRfQ0FST1VTRUxfUExBWSxcbiAgY2Fyb3VzZWxEb3RzQ29uZmlnOiB7IHZpc2libGU6IHRydWUgfSBhcyBEb3RzQ29uZmlnLFxuICBjYXJvdXNlbFNsaWRlSW5maW5pdGU6IHRydWUsXG4gIGVuYWJsZUNsb3NlT3V0c2lkZTogdHJ1ZVxufSk7XG5cbi8qKlxuICogU2VydmljZSB0byBoYW5kbGUgbGlicmFyeSBjb25maWd1cmF0aW9uIGluIGEgdW5pcXVlIHBsYWNlXG4gKi9cbkBJbmplY3RhYmxlKHsgcHJvdmlkZWRJbjogJ3Jvb3QnIH0pXG5leHBvcnQgY2xhc3MgQ29uZmlnU2VydmljZSB7XG4gIGNvbmZpZ01hcDogTWFwPG51bWJlciwgTGliQ29uZmlnPiA9IG5ldyBNYXA8bnVtYmVyLCBMaWJDb25maWc+KCk7XG5cbiAgZ2V0Q29uZmlnKGlkOiBudW1iZXIpOiBMaWJDb25maWcgfCB1bmRlZmluZWQge1xuICAgIHRoaXMuaW5pdElmTm90RXhpc3RzKGlkKTtcbiAgICByZXR1cm4gdGhpcy5jb25maWdNYXAuZ2V0KGlkKTtcbiAgfVxuXG4gIHNldENvbmZpZyhpZDogbnVtYmVyLCBvYmo6IExpYkNvbmZpZyB8IHVuZGVmaW5lZCk6IHZvaWQge1xuICAgIHRoaXMuaW5pdElmTm90RXhpc3RzKGlkKTtcbiAgICBpZiAoIW9iaikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChcbiAgICAgICFERUZBVUxUX0NPTkZJRyB8fFxuICAgICAgIURFRkFVTFRfQ09ORklHLnNsaWRlQ29uZmlnIHx8XG4gICAgICAhREVGQVVMVF9DT05GSUcuc2xpZGVDb25maWcuc2lkZVByZXZpZXdzIHx8XG4gICAgICAhREVGQVVMVF9DT05GSUcucHJldmlld0NvbmZpZyB8fFxuICAgICAgIURFRkFVTFRfQ09ORklHLnByZXZpZXdDb25maWcuc2l6ZSB8fFxuICAgICAgIURFRkFVTFRfQ09ORklHLnByZXZpZXdDb25maWcubnVtYmVyIHx8XG4gICAgICAhREVGQVVMVF9DT05GSUcucGxhaW5HYWxsZXJ5Q29uZmlnIHx8XG4gICAgICAhREVGQVVMVF9DT05GSUcuY3VycmVudEltYWdlQ29uZmlnIHx8XG4gICAgICAhREVGQVVMVF9DT05GSUcuY3VycmVudEltYWdlQ29uZmlnIHx8XG4gICAgICAhREVGQVVMVF9DT05GSUcuY3VycmVudEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uIHx8XG4gICAgICAhREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxJbWFnZUNvbmZpZyB8fFxuICAgICAgIURFRkFVTFRfQ09ORklHLmNhcm91c2VsSW1hZ2VDb25maWcuZGVzY3JpcHRpb24gfHxcbiAgICAgICFERUZBVUxUX0NPTkZJRy5jYXJvdXNlbFByZXZpZXdzQ29uZmlnIHx8XG4gICAgICAhREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZy5icmVha3BvaW50cyB8fFxuICAgICAgIURFRkFVTFRfQ0FST1VTRUxfUFJFVklFV1NfQ09ORklHLm51bWJlclxuICAgICkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnRlcm5hbCBsaWJyYXJ5IGVycm9yIC0gREVGQVVMVF9DT05GSUcgbXVzdCBiZSBmdWxseSBpbml0aWFsaXplZCEhIScpO1xuICAgIH1cblxuICAgIGNvbnN0IG5ld0NvbmZpZzogTGliQ29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5jb25maWdNYXAuZ2V0KGlkKSk7XG4gICAgaWYgKG9iai5zbGlkZUNvbmZpZykge1xuICAgICAgbGV0IHBsYXlDb25maWc7XG4gICAgICBsZXQgc2lkZVByZXZpZXdzO1xuICAgICAgbGV0IHNpemU7XG4gICAgICBpZiAob2JqLnNsaWRlQ29uZmlnLnBsYXlDb25maWcpIHtcbiAgICAgICAgcGxheUNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLnNsaWRlQ29uZmlnLnBsYXlDb25maWcsIG9iai5zbGlkZUNvbmZpZy5wbGF5Q29uZmlnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBsYXlDb25maWcgPSBERUZBVUxUX0NPTkZJRy5zbGlkZUNvbmZpZy5wbGF5Q29uZmlnO1xuICAgICAgfVxuICAgICAgaWYgKG9iai5zbGlkZUNvbmZpZy5zaWRlUHJldmlld3MpIHtcbiAgICAgICAgaWYgKG9iai5zbGlkZUNvbmZpZy5zaWRlUHJldmlld3Muc2l6ZSkge1xuICAgICAgICAgIHNpemUgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5zbGlkZUNvbmZpZy5zaWRlUHJldmlld3Muc2l6ZSwgb2JqLnNsaWRlQ29uZmlnLnNpZGVQcmV2aWV3cy5zaXplKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzaXplID0gREVGQVVMVF9DT05GSUcuc2xpZGVDb25maWcuc2lkZVByZXZpZXdzLnNpemU7XG4gICAgICAgIH1cbiAgICAgICAgc2lkZVByZXZpZXdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuc2xpZGVDb25maWcuc2lkZVByZXZpZXdzLCBvYmouc2xpZGVDb25maWcuc2lkZVByZXZpZXdzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNpZGVQcmV2aWV3cyA9IERFRkFVTFRfQ09ORklHLnNsaWRlQ29uZmlnLnNpZGVQcmV2aWV3cztcbiAgICAgICAgc2l6ZSA9IERFRkFVTFRfQ09ORklHLnNsaWRlQ29uZmlnLnNpZGVQcmV2aWV3cy5zaXplO1xuICAgICAgfVxuICAgICAgY29uc3QgbmV3U2xpZGVDb25maWc6IFNsaWRlQ29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuc2xpZGVDb25maWcsIG9iai5zbGlkZUNvbmZpZyk7XG4gICAgICBuZXdTbGlkZUNvbmZpZy5wbGF5Q29uZmlnID0gcGxheUNvbmZpZztcbiAgICAgIG5ld1NsaWRlQ29uZmlnLnNpZGVQcmV2aWV3cyA9IHNpZGVQcmV2aWV3cztcbiAgICAgIG5ld1NsaWRlQ29uZmlnLnNpZGVQcmV2aWV3cy5zaXplID0gc2l6ZTtcbiAgICAgIG5ld0NvbmZpZy5zbGlkZUNvbmZpZyA9IG5ld1NsaWRlQ29uZmlnO1xuICAgIH1cbiAgICBpZiAob2JqLmFjY2Vzc2liaWxpdHlDb25maWcpIHtcbiAgICAgIG5ld0NvbmZpZy5hY2Nlc3NpYmlsaXR5Q29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuYWNjZXNzaWJpbGl0eUNvbmZpZywgb2JqLmFjY2Vzc2liaWxpdHlDb25maWcpO1xuICAgIH1cbiAgICBpZiAob2JqLnByZXZpZXdDb25maWcpIHtcbiAgICAgIGxldCBzaXplOiBTaXplO1xuICAgICAgbGV0IG51bTogbnVtYmVyO1xuICAgICAgaWYgKG9iai5wcmV2aWV3Q29uZmlnLnNpemUpIHtcbiAgICAgICAgc2l6ZSA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLnByZXZpZXdDb25maWcuc2l6ZSwgb2JqLnByZXZpZXdDb25maWcuc2l6ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzaXplID0gREVGQVVMVF9DT05GSUcucHJldmlld0NvbmZpZy5zaXplO1xuICAgICAgfVxuICAgICAgaWYgKG9iai5wcmV2aWV3Q29uZmlnLm51bWJlcikge1xuICAgICAgICBpZiAob2JqLnByZXZpZXdDb25maWcubnVtYmVyIDw9IDApIHtcbiAgICAgICAgICAvLyBpZiBudW1iZXIgaXMgPD0gMCByZXNldCB0byBkZWZhdWx0XG4gICAgICAgICAgbnVtID0gREVGQVVMVF9DT05GSUcucHJldmlld0NvbmZpZy5udW1iZXI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbnVtID0gb2JqLnByZXZpZXdDb25maWcubnVtYmVyO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBudW0gPSBERUZBVUxUX0NPTkZJRy5wcmV2aWV3Q29uZmlnLm51bWJlcjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IG5ld1ByZXZpZXdDb25maWc6IFByZXZpZXdDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5wcmV2aWV3Q29uZmlnLCBvYmoucHJldmlld0NvbmZpZyk7XG4gICAgICBuZXdQcmV2aWV3Q29uZmlnLnNpemUgPSBzaXplO1xuICAgICAgbmV3UHJldmlld0NvbmZpZy5udW1iZXIgPSBudW07XG4gICAgICBuZXdDb25maWcucHJldmlld0NvbmZpZyA9IG5ld1ByZXZpZXdDb25maWc7XG4gICAgfVxuICAgIGlmIChvYmouYnV0dG9uc0NvbmZpZykge1xuICAgICAgbmV3Q29uZmlnLmJ1dHRvbnNDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5idXR0b25zQ29uZmlnLCBvYmouYnV0dG9uc0NvbmZpZyk7XG4gICAgfVxuICAgIGlmIChvYmouZG90c0NvbmZpZykge1xuICAgICAgbmV3Q29uZmlnLmRvdHNDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5kb3RzQ29uZmlnLCBvYmouZG90c0NvbmZpZyk7XG4gICAgfVxuICAgIGlmIChvYmoucGxhaW5HYWxsZXJ5Q29uZmlnKSB7XG4gICAgICBsZXQgYWR2YW5jZWQ7XG4gICAgICBsZXQgbGF5b3V0O1xuICAgICAgaWYgKG9iai5wbGFpbkdhbGxlcnlDb25maWcuYWR2YW5jZWQpIHtcbiAgICAgICAgYWR2YW5jZWQgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5wbGFpbkdhbGxlcnlDb25maWcuYWR2YW5jZWQsIG9iai5wbGFpbkdhbGxlcnlDb25maWcuYWR2YW5jZWQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWR2YW5jZWQgPSBERUZBVUxUX0NPTkZJRy5wbGFpbkdhbGxlcnlDb25maWcuYWR2YW5jZWQ7XG4gICAgICB9XG4gICAgICBpZiAob2JqLnBsYWluR2FsbGVyeUNvbmZpZy5sYXlvdXQpIHtcbiAgICAgICAgLy8gaXQgaXNuJ3QgbWFuZGF0b3J5IHRvIHVzZSBhc3NpZ24sIGJlY2F1c2Ugb2JqLnBsYWluR2FsbGVyeUNvbmZpZy5sYXlvdXQgaXMgYW4gaW5zdGFuY2Ugb2YgY2xhc3MgKExpbmVhTGF5b3V0LCBHcmlkTGF5b3V0KVxuICAgICAgICBsYXlvdXQgPSBvYmoucGxhaW5HYWxsZXJ5Q29uZmlnLmxheW91dDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxheW91dCA9IERFRkFVTFRfQ09ORklHLnBsYWluR2FsbGVyeUNvbmZpZy5sYXlvdXQ7XG4gICAgICB9XG4gICAgICBjb25zdCBuZXdQbGFpbkdhbGxlcnlDb25maWc6IFBsYWluR2FsbGVyeUNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLnBsYWluR2FsbGVyeUNvbmZpZywgb2JqLnBsYWluR2FsbGVyeUNvbmZpZyk7XG4gICAgICBuZXdQbGFpbkdhbGxlcnlDb25maWcubGF5b3V0ID0gbGF5b3V0O1xuICAgICAgbmV3UGxhaW5HYWxsZXJ5Q29uZmlnLmFkdmFuY2VkID0gYWR2YW5jZWQ7XG4gICAgICBuZXdDb25maWcucGxhaW5HYWxsZXJ5Q29uZmlnID0gaW5pdFBsYWluR2FsbGVyeUNvbmZpZyhuZXdQbGFpbkdhbGxlcnlDb25maWcpO1xuICAgIH1cbiAgICBpZiAob2JqLmN1cnJlbnRJbWFnZUNvbmZpZykge1xuICAgICAgbGV0IGxvYWRpbmc7XG4gICAgICBsZXQgZGVzY3JpcHRpb247XG4gICAgICBsZXQgZGVzY3JpcHRpb25TdHlsZTtcbiAgICAgIGlmIChvYmouY3VycmVudEltYWdlQ29uZmlnLmxvYWRpbmdDb25maWcpIHtcbiAgICAgICAgbG9hZGluZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLmN1cnJlbnRJbWFnZUNvbmZpZy5sb2FkaW5nQ29uZmlnLCBvYmouY3VycmVudEltYWdlQ29uZmlnLmxvYWRpbmdDb25maWcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9hZGluZyA9IERFRkFVTFRfQ09ORklHLmN1cnJlbnRJbWFnZUNvbmZpZy5sb2FkaW5nQ29uZmlnO1xuICAgICAgfVxuICAgICAgaWYgKG9iai5jdXJyZW50SW1hZ2VDb25maWcuZGVzY3JpcHRpb24pIHtcbiAgICAgICAgZGVzY3JpcHRpb24gPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5jdXJyZW50SW1hZ2VDb25maWcuZGVzY3JpcHRpb24sIG9iai5jdXJyZW50SW1hZ2VDb25maWcuZGVzY3JpcHRpb24pO1xuICAgICAgICBpZiAob2JqLmN1cnJlbnRJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbi5zdHlsZSkge1xuICAgICAgICAgIGRlc2NyaXB0aW9uU3R5bGUgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5jdXJyZW50SW1hZ2VDb25maWcuZGVzY3JpcHRpb24uc3R5bGUsIG9iai5jdXJyZW50SW1hZ2VDb25maWcuZGVzY3JpcHRpb24uc3R5bGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRlc2NyaXB0aW9uU3R5bGUgPSBERUZBVUxUX0NPTkZJRy5jdXJyZW50SW1hZ2VDb25maWcuZGVzY3JpcHRpb24uc3R5bGU7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRlc2NyaXB0aW9uID0gREVGQVVMVF9DT05GSUcuY3VycmVudEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uO1xuICAgICAgICBkZXNjcmlwdGlvblN0eWxlID0gREVGQVVMVF9DT05GSUcuY3VycmVudEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uLnN0eWxlO1xuICAgICAgfVxuICAgICAgY29uc3QgbmV3Q3VycmVudEltYWdlQ29uZmlnOiBDdXJyZW50SW1hZ2VDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5jdXJyZW50SW1hZ2VDb25maWcsIG9iai5jdXJyZW50SW1hZ2VDb25maWcpO1xuICAgICAgbmV3Q3VycmVudEltYWdlQ29uZmlnLmxvYWRpbmdDb25maWcgPSBsb2FkaW5nO1xuICAgICAgbmV3Q3VycmVudEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICBuZXdDdXJyZW50SW1hZ2VDb25maWcuZGVzY3JpcHRpb24uc3R5bGUgPSBkZXNjcmlwdGlvblN0eWxlO1xuICAgICAgbmV3Q29uZmlnLmN1cnJlbnRJbWFnZUNvbmZpZyA9IG5ld0N1cnJlbnRJbWFnZUNvbmZpZztcbiAgICB9XG4gICAgaWYgKG9iai5rZXlib2FyZENvbmZpZykge1xuICAgICAgbmV3Q29uZmlnLmtleWJvYXJkQ29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcua2V5Ym9hcmRDb25maWcsIG9iai5rZXlib2FyZENvbmZpZyk7XG4gICAgfVxuXG4gICAgLy8gY2Fyb3VzZWxcbiAgICBpZiAob2JqLmNhcm91c2VsQ29uZmlnKSB7XG4gICAgICBuZXdDb25maWcuY2Fyb3VzZWxDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5jYXJvdXNlbENvbmZpZywgb2JqLmNhcm91c2VsQ29uZmlnKTtcbiAgICB9XG4gICAgaWYgKG9iai5jYXJvdXNlbEltYWdlQ29uZmlnKSB7XG4gICAgICBsZXQgZGVzY3JpcHRpb247XG4gICAgICBsZXQgZGVzY3JpcHRpb25TdHlsZTtcbiAgICAgIGlmIChvYmouY2Fyb3VzZWxJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbikge1xuICAgICAgICBkZXNjcmlwdGlvbiA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLmNhcm91c2VsSW1hZ2VDb25maWcuZGVzY3JpcHRpb24sIG9iai5jYXJvdXNlbEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgaWYgKG9iai5jYXJvdXNlbEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uLnN0eWxlKSB7XG4gICAgICAgICAgZGVzY3JpcHRpb25TdHlsZSA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLmNhcm91c2VsSW1hZ2VDb25maWcuZGVzY3JpcHRpb24uc3R5bGUsIG9iai5jYXJvdXNlbEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uLnN0eWxlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkZXNjcmlwdGlvblN0eWxlID0gREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbi5zdHlsZTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGVzY3JpcHRpb24gPSBERUZBVUxUX0NPTkZJRy5jYXJvdXNlbEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uO1xuICAgICAgICBkZXNjcmlwdGlvblN0eWxlID0gREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbi5zdHlsZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IG5ld0Nhcm91c2VsSW1hZ2VDb25maWc6IENhcm91c2VsSW1hZ2VDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5jYXJvdXNlbEltYWdlQ29uZmlnLCBvYmouY2Fyb3VzZWxJbWFnZUNvbmZpZyk7XG4gICAgICBuZXdDYXJvdXNlbEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICBuZXdDYXJvdXNlbEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uLnN0eWxlID0gZGVzY3JpcHRpb25TdHlsZTtcbiAgICAgIG5ld0NvbmZpZy5jYXJvdXNlbEltYWdlQ29uZmlnID0gbmV3Q2Fyb3VzZWxJbWFnZUNvbmZpZztcbiAgICB9XG4gICAgaWYgKG9iai5jYXJvdXNlbFBsYXlDb25maWcpIHtcbiAgICAgIC8vIGNoZWNrIHZhbHVlc1xuICAgICAgaWYgKG9iai5jYXJvdXNlbFBsYXlDb25maWcuaW50ZXJ2YWwgPD0gMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhcm91c2VsJ3MgaW50ZXJ2YWwgbXVzdCBiZSBhIG51bWJlciA+PSAwYCk7XG4gICAgICB9XG4gICAgICBuZXdDb25maWcuY2Fyb3VzZWxQbGF5Q29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxQbGF5Q29uZmlnLCBvYmouY2Fyb3VzZWxQbGF5Q29uZmlnKTtcbiAgICB9XG4gICAgaWYgKG9iai5jYXJvdXNlbFByZXZpZXdzQ29uZmlnKSB7XG4gICAgICAvLyBjaGVjayB2YWx1ZXNcbiAgICAgIGxldCBudW06IG51bWJlcjtcbiAgICAgIGxldCBicmVha3BvaW50czogQnJlYWtwb2ludHNDb25maWc7XG4gICAgICBpZiAoIW9iai5jYXJvdXNlbFByZXZpZXdzQ29uZmlnLm51bWJlciB8fCBvYmouY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZy5udW1iZXIgPD0gMCkge1xuICAgICAgICBudW0gPSBERUZBVUxUX0NBUk9VU0VMX1BSRVZJRVdTX0NPTkZJRy5udW1iZXI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBudW0gPSBvYmouY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZy5udW1iZXI7XG4gICAgICB9XG4gICAgICBpZiAob2JqLmNhcm91c2VsUHJldmlld3NDb25maWcuYnJlYWtwb2ludHMpIHtcbiAgICAgICAgYnJlYWtwb2ludHMgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5jYXJvdXNlbFByZXZpZXdzQ29uZmlnLmJyZWFrcG9pbnRzLCBvYmouY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZy5icmVha3BvaW50cyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBicmVha3BvaW50cyA9IERFRkFVTFRfQ09ORklHLmNhcm91c2VsUHJldmlld3NDb25maWcuYnJlYWtwb2ludHM7XG4gICAgICB9XG4gICAgICBuZXdDb25maWcuY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLmNhcm91c2VsUHJldmlld3NDb25maWcsIG9iai5jYXJvdXNlbFByZXZpZXdzQ29uZmlnKTtcbiAgICAgIG5ld0NvbmZpZy5jYXJvdXNlbFByZXZpZXdzQ29uZmlnLm51bWJlciA9IG51bTtcbiAgICAgIG5ld0NvbmZpZy5jYXJvdXNlbFByZXZpZXdzQ29uZmlnLmJyZWFrcG9pbnRzID0gYnJlYWtwb2ludHM7XG4gICAgICAvLyBJbml0IHByZXZpZXcgaW1hZ2Ugd2lkdGggYmFzZWQgb24gdGhlIG51bWJlciBvZiBwcmV2aWV3cyBpbiBQcmV2aWV3Q29uZmlnXG4gICAgICAvLyBEb24ndCBtb3ZlIHRoaXMgbGluZSBhYm92ZSwgYmVjYXVzZSBJIG5lZWQgdG8gYmUgc3VyZSB0aGF0IGJvdGggY29uZmlnUHJldmlldy5udW1iZXJcbiAgICAgIC8vIGFuZCBjb25maWdQcmV2aWV3LnNpemUgYXJlIGluaXRpYWxpemVkXG4gICAgICBuZXdDb25maWcuY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZy53aWR0aCA9IDEwMCAvIG5ld0NvbmZpZy5jYXJvdXNlbFByZXZpZXdzQ29uZmlnLm51bWJlciArICclJztcbiAgICB9XG4gICAgaWYgKG9iai5jYXJvdXNlbERvdHNDb25maWcpIHtcbiAgICAgIG5ld0NvbmZpZy5jYXJvdXNlbERvdHNDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5jYXJvdXNlbERvdHNDb25maWcsIG9iai5jYXJvdXNlbERvdHNDb25maWcpO1xuICAgIH1cbiAgICBpZiAob2JqLmNhcm91c2VsU2xpZGVJbmZpbml0ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBuZXdDb25maWcuY2Fyb3VzZWxTbGlkZUluZmluaXRlID0gREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxTbGlkZUluZmluaXRlO1xuICAgIH0gZWxzZSB7XG4gICAgICBuZXdDb25maWcuY2Fyb3VzZWxTbGlkZUluZmluaXRlID0gb2JqLmNhcm91c2VsU2xpZGVJbmZpbml0ZTtcbiAgICB9XG4gICAgaWYgKG9iai5lbmFibGVDbG9zZU91dHNpZGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgbmV3Q29uZmlnLmVuYWJsZUNsb3NlT3V0c2lkZSA9IERFRkFVTFRfQ09ORklHLmVuYWJsZUNsb3NlT3V0c2lkZTtcbiAgICB9IGVsc2Uge1xuICAgICAgbmV3Q29uZmlnLmVuYWJsZUNsb3NlT3V0c2lkZSA9IG9iai5lbmFibGVDbG9zZU91dHNpZGU7XG4gICAgfVxuICAgIHRoaXMuY29uZmlnTWFwLnNldChpZCwgbmV3Q29uZmlnKTtcbiAgfVxuXG4gIHByaXZhdGUgaW5pdElmTm90RXhpc3RzKGlkOiBudW1iZXIpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuY29uZmlnTWFwLmhhcyhpZCkpIHtcbiAgICAgIHRoaXMuY29uZmlnTWFwLnNldChpZCwgREVGQVVMVF9DT05GSUcpO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIEZ1bmN0aW9uIHRvIGJ1aWxkIGFuZCByZXR1cm4gYSBgUGxhaW5HYWxsZXJ5Q29uZmlnYCBvYmplY3QsIHByb3ZpbmcgYWxzbyBkZWZhdWx0IHZhbHVlcyBhbmQgdmFsaWRhdGluZyB0aGUgaW5wdXQgb2JqZWN0LlxuICogQHBhcmFtIHBsYWluR2FsbGVyeUNvbmZpZyBvYmplY3Qgd2l0aCB0aGUgY29uZmlnIHJlcXVlc3RlZCBieSB1c2VyXG4gKiBAcmV0dXJucyBQbGFpbkdhbGxlcnlDb25maWcgdGhlIHBsYWluIGdhbGxlcnkgY29uZmlndXJhdGlvblxuICogQHRocm93cyBhbiBFcnJvciBpZiBsYXlvdXQgYW5kIHN0cmF0ZWd5IGFyZW4ndCBjb21wYXRpYmxlXG4gKi9cbmZ1bmN0aW9uIGluaXRQbGFpbkdhbGxlcnlDb25maWcocGxhaW5HYWxsZXJ5Q29uZmlnOiBQbGFpbkdhbGxlcnlDb25maWcpOiBQbGFpbkdhbGxlcnlDb25maWcge1xuICBjb25zdCBuZXdQbGF5R2FsbGVyeUNvbmZpZzogUGxhaW5HYWxsZXJ5Q29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcucGxhaW5HYWxsZXJ5Q29uZmlnLCBwbGFpbkdhbGxlcnlDb25maWcpO1xuXG4gIGlmIChuZXdQbGF5R2FsbGVyeUNvbmZpZy5sYXlvdXQgaW5zdGFuY2VvZiBMaW5lTGF5b3V0KSB7XG4gICAgaWYgKG5ld1BsYXlHYWxsZXJ5Q29uZmlnLnN0cmF0ZWd5ICE9PSBQbGFpbkdhbGxlcnlTdHJhdGVneS5ST1cgJiYgbmV3UGxheUdhbGxlcnlDb25maWcuc3RyYXRlZ3kgIT09IFBsYWluR2FsbGVyeVN0cmF0ZWd5LkNPTFVNTikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdMaW5lTGF5b3V0IHJlcXVpcmVzIGVpdGhlciBST1cgb3IgQ09MVU1OIHN0cmF0ZWd5Jyk7XG4gICAgfVxuICAgIGlmICghbmV3UGxheUdhbGxlcnlDb25maWcubGF5b3V0IHx8ICFuZXdQbGF5R2FsbGVyeUNvbmZpZy5sYXlvdXQuYnJlYWtDb25maWcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQm90aCBsYXlvdXQgYW5kIGJyZWFrQ29uZmlnIG11c3QgYmUgdmFsaWQnKTtcbiAgICB9XG4gIH1cblxuICBpZiAobmV3UGxheUdhbGxlcnlDb25maWcubGF5b3V0IGluc3RhbmNlb2YgR3JpZExheW91dCkge1xuICAgIGlmIChuZXdQbGF5R2FsbGVyeUNvbmZpZy5zdHJhdGVneSAhPT0gUGxhaW5HYWxsZXJ5U3RyYXRlZ3kuR1JJRCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdHcmlkTGF5b3V0IHJlcXVpcmVzIEdSSUQgc3RyYXRlZ3knKTtcbiAgICB9XG4gICAgaWYgKCFuZXdQbGF5R2FsbGVyeUNvbmZpZy5sYXlvdXQgfHwgIW5ld1BsYXlHYWxsZXJ5Q29uZmlnLmxheW91dC5icmVha0NvbmZpZykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdCb3RoIGxheW91dCBhbmQgYnJlYWtDb25maWcgbXVzdCBiZSB2YWxpZCcpO1xuICAgIH1cbiAgICAvLyBmb3JjZSB3cmFwIGZvciBncmlkIGxheW91dFxuICAgIG5ld1BsYXlHYWxsZXJ5Q29uZmlnLmxheW91dC5icmVha0NvbmZpZy53cmFwID0gdHJ1ZTtcbiAgfVxuICByZXR1cm4gbmV3UGxheUdhbGxlcnlDb25maWc7XG59XG4iXX0=